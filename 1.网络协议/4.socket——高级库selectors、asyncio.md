# socket——高级库selectors、asyncyio

## selectors

- selectors是什么？
    - 包装多种select机制
    - 更高级、更易用
    - 统一的API

    [官方文档](https://docs.python.org/3/library/selectors.html)

- selectors库中的类

    ```
    BaseSelector
    +-- SelectSelector
    +-- PollSelector
    +-- EpollSelector
    +-- DevpollSelector
    +-- KqueueSelector
    ```

- 选择最佳的select机制

    ```python
    import selectors
    # 返回本操作系统中最高效的select实现：
    sel = selectors.DefaultSelector()
    ```

- 事件
    + EVENT_READ
    + EVENT_WRITE

- 主要方法
    + `register(fileobj, events, data=None)`
    + `select(timeout=None)`
    + `modify(fileobj, events, data=None)`
    + `unregister(fileobj)`

- 样例程序

  [聊天室服务器（selectors实现版本）](programs/ChatroomServer_selectors.py)

## asyncio中的网络IO操作

- `async`与`await`
    + `async`定义的函数需要用`await`来调用
    + `await`调用`async`函数运行后，称为协程
    + 系统一般不仅在一个`await`处等待，而是停留在多个`await`处，哪处执行完毕，哪处就继续往下走
    + 协程很好的解决了并发等待的问题

- 异步网络操作的函数与类
    + TCP服务器启动函数

      `asyncio.start_server`

    + TCP客户端连接函数

      `asyncio.open_connection`

    + 输入对象

      `asyncio.StreamReader`

    + 输出对象

      `asyncio.StreamWriter`

    [官方文档](https://docs.python.org/3/library/asyncio-stream.html)

- 样例程序

  [聊天室服务器（asyncio实现版本）](programs/ChatroomServer_asyncio.py)

## 核心词汇

- `register`

  登记、注册

- `async`

  asynchronous，异步的；反义词是sync，同步的。

- `coroutine`

  协程